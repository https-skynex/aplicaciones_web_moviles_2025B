<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supervisi贸n de IA | Admin Panel</title>
    <link rel="stylesheet" href="../../css/style/base/main.css">
    <link rel="stylesheet" href="../../css/style/components/sidebar.css">
    <link rel="stylesheet" href="../../css/style/pages/supervision_categorias.css">
    <link rel="stylesheet" href="../../css/style/pages/modal_correccion_ia.css">
</head>
<body>

<!-- Modal de correcci贸n de IA (incluido como en config_perfiles) -->
<div class="modal-overlay-ia" style="display: none;">
    <div class="modal-content-ia">
        <div class="modal-header-ia">
            <h3 class="modal-title-ia">Corregir Clasificaci贸n de IA</h3>
            <button class="modal-close-ia" aria-label="Cerrar modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="modal-body-ia">
            <!-- Informaci贸n del registro original -->
            <div class="original-info">
                <h4> Informaci贸n Original</h4>
                <div class="info-row">
                    <span class="label">Descripci贸n del usuario:</span>
                    <span class="value original-description"></span>
                </div>
                <div class="info-row">
                    <span class="label">Palabra clave detectada (IA):</span>
                    <span class="value original-keyword"></span>
                </div>
                <div class="info-row">
                    <span class="label">Categor铆a asignada (IA):</span>
                    <span class="value original-category"></span>
                </div>
                <div class="info-row">
                    <span class="label">Nivel de confianza:</span>
                    <span class="value original-confidence"></span>
                </div>
            </div>

            <!-- Formulario de correcci贸n -->
            <form class="correction-form">
                <!-- An谩lisis de palabras clave -->
                <div class="form-section">
                    <h4> An谩lisis de Palabras Clave</h4>
                    <p class="helper-text">El sistema ha detectado las siguientes palabras en la descripci贸n. Selecciona cu谩l deber铆a tener mayor peso:</p>
                    <div class="keywords-detected"></div>
                </div>

                <!-- Nueva clasificaci贸n -->
                <div class="form-section">
                    <h4>锔 Nueva Clasificaci贸n</h4>
                    
                    <div class="form-group">
                        <label for="corrected-keyword">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            Palabra clave principal *
                        </label>
                        <input 
                            type="text" 
                            id="corrected-keyword" 
                            placeholder="Ej: cine, pareja, amigos..."
                            required
                        >
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="corrected-category">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z"></path>
                            </svg>
                            Categor铆a/rea *
                        </label>
                        <select id="corrected-category" required>
                            <option value="">Selecciona una categor铆a</option>
                        </select>
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="keyword-weight">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                            Peso de la palabra clave (0-100) *
                        </label>
                        <div class="weight-input-group">
                            <input 
                                type="range" 
                                id="keyword-weight" 
                                min="0" 
                                max="100" 
                                value="50"
                            >
                            <span class="weight-value">50</span>
                        </div>
                        <p class="helper-text">Mayor peso = Mayor relevancia en futuras clasificaciones</p>
                    </div>
                </div>

                <!-- Opciones de entrenamiento -->
                <div class="form-section training-options">
                    <h4> Opciones de Entrenamiento del Modelo</h4>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="create-permanent-rule" name="create-rule">
                        <label for="create-permanent-rule">
                            <strong>Crear regla permanente</strong>
                            <span class="helper-text">Esta palabra clave siempre se clasificar谩 en esta categor铆a</span>
                        </label>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="apply-similar" name="apply-similar">
                        <label for="apply-similar">
                            <strong>Aplicar a descripciones similares</strong>
                            <span class="helper-text">Buscar y corregir autom谩ticamente descripciones parecidas</span>
                        </label>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="retrain-model" name="retrain-model" checked>
                        <label for="retrain-model">
                            <strong>Usar para reentrenamiento</strong>
                            <span class="helper-text">Esta correcci贸n mejorar谩 el modelo de IA (recomendado)</span>
                        </label>
                    </div>
                </div>

                <!-- Notas adicionales -->
                <div class="form-section">
                    <div class="form-group">
                        <label for="correction-notes">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Notas (opcional)
                        </label>
                        <textarea 
                            id="correction-notes" 
                            rows="3"
                            placeholder="Ej: Esta palabra suele indicar gastos relacionados con..."
                        ></textarea>
                    </div>
                </div>

                <!-- Botones de acci贸n -->
                <div class="modal-footer-ia">
                    <button type="button" class="btn-secondary-ia cancel-correction">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary-ia submit-correction">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        Aplicar Correcci贸n
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="container">
    <div id="sidebar-container" data-sidebar="admin"></div>
    <main class="main-content">
        
        <div class="kpi-container">
            <div class="kpi-card">
                <h4>Precisi贸n del modelo</h4>
                <p>96.5%</p>
                <span>ltimos 7 d铆as</span>
            </div>
            <div class="kpi-card">
                <h4>Correcciones manuales</h4>
                <p>82</p>
                <span>ltimos 7 d铆as</span>
            </div>
            <div class="kpi-card">
                <h4>Categor铆as problem谩ticas</h4>
                <ul class="problem-list">
                    <li>1. Suscripciones</li>
                    <li>2. Transporte</li>
                </ul>
            </div>
        </div>

        <section class="card">
            <h4>Campo de Pruebas de la IA</h4>
            <div class="ai-playground">
                <div class="input-group">
                    <label for="ai-test-input">Ingresa una descripci贸n para probar:</label>
                    <input type="text" id="ai-test-input" placeholder="Ej: 'Pago de la luz'">
                </div>
                <button id="ai-test-btn">Probar</button>
            </div>
            <div id="ai-prediction-result"></div>
        </section>

        <div class="charts-grid">
            <section class="card">
                <h4>Distribuci贸n de Confianza</h4>
                <canvas id="confidenceChart"></canvas>
            </section>
            <section class="card">
                <h4>Tendencia de Correcciones</h4>
                <canvas id="correctionsTrendChart"></canvas>
            </section>
        </div>

        <section class="card">
            <div class="filters-bar">
                <select id="confidence-filter">
                    <option value="todos">Todos los niveles</option>
                    <option value="baja">Confianza Baja</option>
                    <option value="media">Confianza Media</option>
                    <option value="alta">Confianza Alta</option>
                </select>
                <input type="text" id="search-input" placeholder="Buscar por descripci贸n...">
            </div>

            <table class="supervision-table">
                <thead>
                    <tr>
                        <th>Descripci贸n del usuario</th>
                        <th>Palabra clave IA</th>
                        <th>Categor铆a general IA</th>
                        <th>Confianza</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="supervision-tbody"></tbody>
            </table>
        </section>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="../../js/supervision-categorias.js"></script>
<script src="../../js/main.js"></script>
</body>
</html>

